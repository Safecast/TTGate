<html>
    <head>
        <title>Main Kiosk Page</title>
        <meta http-equiv="refresh" content="30">
    </head>
    <body onload="loadData()">
        <script>
         function loadData()
         {
             var xhr = new XMLHttpRequest();
             xhr.onreadystatechange = function()
             {
                 if (xhr.readyState === XMLHttpRequest.DONE) {
                     if (xhr.status === 200) {
                         processData(JSON.parse(xhr.responseText));
                     }
                 }
             };
             xhr.open("GET", "http://localhost:8080/data.json", true);
             xhr.send();
         }
         function processData(data) {
             var table = document.getElementById("datatable");
             var tr;
             for (var i = 0; i < data.length; i++) {
                 tr = table.insertRow(-1);
                 cell = tr.insertCell(-1); cell.innerHTML = data[i].device_id;
                 cell = tr.insertCell(-1); cell.innerHTML = data[i].captured_local;
                 cell = tr.insertCell(-1); cell.innerHTML = data[i].unit;
                 cell = tr.insertCell(-1); cell.innerHTML = data[i].value0;
                 cell = tr.insertCell(-1); cell.innerHTML = data[i].value1;
                 cell = tr.insertCell(-1); cell.innerHTML = data[i].bat_voltage;
                 cell = tr.insertCell(-1); cell.innerHTML = data[i].bat_soc;
                 cell = tr.insertCell(-1); cell.innerHTML = data[i].env_temp;
                 cell = tr.insertCell(-1); cell.innerHTML = data[i].env_humid;
                 cell = tr.insertCell(-1); cell.innerHTML = data[i].snr;
             }
         }
        </script>
        <script type="text/javascript">
         var currentTime = new Date()
         var hours = currentTime.getHours()
         var minutes = currentTime.getMinutes()
         if (minutes < 10){
             minutes = "0" + minutes
         }
         document.write(hours + ":" + minutes + " ")
         if(hours > 11){
             document.write("PM")
         } else {
             document.write("AM")
         }
        </script>
        <p/>
        <table>
            <tr>
                <th>DeviceID</th>
                <th>Captured</th>
                <th>Unit</th>
                <th>Value#0</th>
                <th>Value#1</th>
                <th>BatVoltage</th>
                <th>BatSOC</th>
                <th>Temperature</th>
                <th>Humidity</th>
                <th>Wireless</th>
            </tr>
        </table>
    </body>
</html>
