<html>
    <head>
        <title>Main Kiosk Page</title>
        <meta http-equiv="refresh" content="15">
    </head>
    <body onload="loadData()">
        <script>
         function loadData()
         {
             var xhr = new XMLHttpRequest();
             xhr.onreadystatechange = function()
             {
                 if (xhr.readyState === XMLHttpRequest.DONE) {
                     if (xhr.status === 200) {
                         processData(JSON.parse(xhr.responseText));
                     }
                 }
             };
             xhr.open("GET", "http://localhost:8080/data.json", true);
             xhr.send();
         }
         function processData(data) {
             var table = document.getElementById("datatable");
             var tr;
             for (var i = 0; i < data.length; i++) {
                 tr = table.insertRow(-1);
                 cell = tr.insertCell(-1); cell.innerHTML = data[i].minutes_ago;
                 cell = tr.insertCell(-1); cell.innerHTML = data[i].captured_local;
                 cell = tr.insertCell(-1); cell.innerHTML = data[i].device_id;
                 cell = tr.insertCell(-1); cell.innerHTML = data[i].lat;
                 cell = tr.insertCell(-1); cell.innerHTML = data[i].lon;
                 cell = tr.insertCell(-1); cell.innerHTML = data[i].lnd7318u;
                 cell = tr.insertCell(-1); cell.innerHTML = data[i].lnd7318c;
                 cell = tr.insertCell(-1); cell.innerHTML = data[i].lnd7128ec;
                 cell = tr.insertCell(-1); cell.innerHTML = data[i].opc_pm02_5;
                 cell = tr.insertCell(-1); cell.innerHTML = data[i].pms_pm02_5;
                 cell = tr.insertCell(-1); cell.innerHTML = data[i].bat_voltage;
                 cell = tr.insertCell(-1); cell.innerHTML = data[i].bat_soc;
                 cell = tr.insertCell(-1); cell.innerHTML = data[i].env_temp;
                 cell = tr.insertCell(-1); cell.innerHTML = data[i].env_humid;
                 cell = tr.insertCell(-1); cell.innerHTML = data[i].snr;
             }
         }
        </script>
        <p/>
        <table id="datatable" cellpadding="8" border="1">
            <tr>
                <th>Rcv</th>
                <th>Cap</th>
                <th>ID</th>
                <th>Lat</th>
                <th>Lon</th>
                <th>7318u</th>
                <th>7318c</th>
                <th>7128ec</th>
                <th>opc25</th>
                <th>pms25</th>
                <th>V</th>
                <th>%</th>
                <th>Tmp</th>
                <th>Hum</th>
                <th>snr</th>
            </tr>
        </table>
    </body>
</html>
